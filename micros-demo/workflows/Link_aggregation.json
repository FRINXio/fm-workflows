{
  "name": "Link_aggregation",
  "description": "{\"description\": \"Creates a link aggregation between two nodes\", \"labels\": [\"DEMO\",\"LINKAGG\"]}",
  "version": 1,
  "tasks": [
    {
      "name": "fork_join",
      "taskReferenceName": "forkx",
      "type": "FORK_JOIN",
      "forkTasks": [
        [
          {
            "name": "UNICONFIG_write_structured_device_data",
            "taskReferenceName": "UNICONFIG_write_bundle_ether_node1",
            "inputParameters": {
              "device_id": "${workflow.input.node1}",
              "uri": "/frinx-openconfig-interfaces:interfaces/interface=Bundle-Ether${workflow.input.bundle_ether_id}",
              "template": "{\"interface\":[{\"name\":\"Bundle-Ether${workflow.input.bundle_ether_id}\",\"config\":{\"type\":\"iana-if-type:ieee8023adLag\",\"enabled\":${workflow.input.bundle_ether_enabled},\"name\":\"Bundle-Ether${workflow.input.bundle_ether_id}\"}}]}",
              "params": "{}"
            },
            "type": "SIMPLE",
            "startDelay": 0,
            "optional": false,
            "asyncComplete": false
          }
        ],
        [
          {
            "name": "UNICONFIG_write_structured_device_data",
            "taskReferenceName": "UNICONFIG_write_bundle_ether_node2",
            "inputParameters": {
              "device_id": "${workflow.input.node2}",
              "uri": "/frinx-openconfig-interfaces:interfaces/interface=Bundle-Ether${workflow.input.bundle_ether_id}",
              "template": "{\"interface\":[{\"name\":\"Bundle-Ether${workflow.input.bundle_ether_id}\",\"config\":{\"type\":\"iana-if-type:ieee8023adLag\",\"enabled\":${workflow.input.bundle_ether_enabled},\"name\":\"Bundle-Ether${workflow.input.bundle_ether_id}\"}}]}",
              "params": "{}"
            },
            "type": "SIMPLE",
            "startDelay": 0,
            "optional": false,
            "asyncComplete": false
          }
        ]
      ],
      "startDelay": 0,
      "optional": false,
      "asyncComplete": false
    },
    {
      "name": "join",
      "taskReferenceName": "join1",
      "type": "JOIN",
      "startDelay": 0,
      "joinOn": [
        "UNICONFIG_write_bundle_ether_node1",
        "UNICONFIG_write_bundle_ether_node2"
      ],
      "optional": false,
      "asyncComplete": false
    },
    {
      "name": "fork_join",
      "taskReferenceName": "forky",
      "type": "FORK_JOIN",
      "forkTasks": [
        [
          {
            "name": "UNICONFIG_write_structured_data_as_dynamic_fork_tasks",
            "taskReferenceName": "UNICONFIG_write_structured_data_as_tasks_node1",
            "inputParameters": {
              "device_id": "${workflow.input.node1}",
              "uri": "/frinx-openconfig-interfaces:interfaces/interface=$iface",
              "template": "{\"interface\":[{\"name\":\"$iface\",\"config\":{\"type\":\"iana-if-type:ethernetCsmacd\",\"name\":\"$iface\"},\"frinx-openconfig-if-ethernet:ethernet\":{\"config\":{\"frinx-openconfig-if-aggregate:aggregate-id\": \"Bundle-Ether${workflow.input.bundle_ether_id}\"}}}]}",
              "task_params": "${workflow.input.node1_ifaces}"
            },
            "type": "SIMPLE",
            "startDelay": 0,
            "optional": false,
            "asyncComplete": false
          },
          {
            "name": "DYNAMIC_FORK",
            "taskReferenceName": "dynamicForkRefY8W8",
            "inputParameters": {
              "expectedName": "UNICONFIG_write_structured_device_data",
              "expectedType": "SIMPLE",
              "dynamic_tasks": "${UNICONFIG_write_structured_data_as_tasks_node1.output.dynamic_tasks}",
              "dynamic_tasks_i": "${UNICONFIG_write_structured_data_as_tasks_node1.output.dynamic_tasks_i}"
            },
            "type": "SUB_WORKFLOW",
            "startDelay": 0,
            "subWorkflowParam": {
              "name": "Dynamic_fork",
              "version": 1
            },
            "optional": false,
            "asyncComplete": false
          }
        ],
        [
          {
            "name": "UNICONFIG_write_structured_data_as_dynamic_fork_tasks",
            "taskReferenceName": "UNICONFIG_write_structured_data_as_tasks_node2",
            "inputParameters": {
              "device_id": "${workflow.input.node2}",
              "uri": "/frinx-openconfig-interfaces:interfaces/interface=$iface",
              "template": "{\"interface\":[{\"name\":\"$iface\",\"config\":{\"type\":\"iana-if-type:ethernetCsmacd\",\"name\":\"$iface\"},\"frinx-openconfig-if-ethernet:ethernet\":{\"config\":{\"frinx-openconfig-if-aggregate:aggregate-id\": \"Bundle-Ether${workflow.input.bundle_ether_id}\"}}}]}",
              "task_params": "${workflow.input.node2_ifaces}"
            },
            "type": "SIMPLE",
            "startDelay": 0,
            "optional": false,
            "asyncComplete": false
          },
          {
            "name": "DYNAMIC_FORK",
            "taskReferenceName": "dynamicForkRefCEF8",
            "inputParameters": {
              "expectedName": "UNICONFIG_write_structured_device_data",
              "expectedType": "SIMPLE",
              "dynamic_tasks": "${UNICONFIG_write_structured_data_as_tasks_node2.output.dynamic_tasks}",
              "dynamic_tasks_i": "${UNICONFIG_write_structured_data_as_tasks_node2.output.dynamic_tasks_i}"
            },
            "type": "SUB_WORKFLOW",
            "startDelay": 0,
            "subWorkflowParam": {
              "name": "Dynamic_fork",
              "version": 1
            },
            "optional": false,
            "asyncComplete": false
          }
        ]
      ],
      "startDelay": 0,
      "optional": false,
      "asyncComplete": false
    },
    {
      "name": "join",
      "taskReferenceName": "join2",
      "type": "JOIN",
      "startDelay": 0,
      "joinOn": [
        "dynamicForkRefY8W8",
        "dynamicForkRefCEF8"
      ],
      "optional": false,
      "asyncComplete": false
    },
    {
      "name": "UNICONFIG_commit",
      "taskReferenceName": "UNICONFIG_commit_ifaces",
      "inputParameters": {
        "devices": "${workflow.input.node1}, ${workflow.input.node2}"
      },
      "type": "SIMPLE",
      "startDelay": 0,
      "optional": false,
      "asyncComplete": false
    }
  ],
  "inputParameters": [
    "{\"node1\":{\"value\":\"XR01\",\"description\":\"First node to create a link aggregation with\",\"type\":\"string\"},\"bundle_ether_id\":{\"value\":\"3\",\"description\":\"BundleEtherX\",\"type\":\"string\"},\"bundle_ether_enabled\":{\"value\":\"true\",\"description\":\"enabled\",\"type\":\"string\"},\"node2\":{\"value\":\"XR02\",\"description\":\"Second node to create a link aggregation with\",\"type\":\"string\"},\"node1_ifaces\":{\"value\":\"GigabitEthernet0/0/0/0, GigabitEthernet0/0/0/1\",\"description\":\"Interfaces for node1\",\"type\":\"string\"},\"node2_ifaces\":{\"value\":\"GigabitEthernet0/0/0/1, GigabitEthernet0/0/0/2, GigabitEthernet0/0/0/3\",\"description\":\"Interfaces for node2\",\"type\":\"string\"}}"
  ],
  "outputParameters": {
    "Aggregation link ID": "${workflow.input.bundle_ether_id}"
  },
  "schemaVersion": 2,
  "restartable": true,
  "workflowStatusListenerEnabled": true
}
