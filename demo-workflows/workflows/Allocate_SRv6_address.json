{
  "name": "Allocate_SRv6_address",
  "description": "{\"description\":\"Allocate SRv6 address in uniresource\",\"labels\":[\"UNIRESOURCE\"]}",
  "version": 1,
  "tasks": [
    {
      "name": "HTTP_task",
      "taskReferenceName": "graphql_Search_root_pool",
      "inputParameters": {
        "http_request": {
          "contentType": "application/json",
          "method": "POST",
          "headers": {
            "x-tenant-id": "frinx",
            "from": "workflow",
            "x-auth-user-groups": "All.ReadWrite"
          },
          "timeout": 3600,
          "uri": "http://uniresource:8884/query",
          "body": {
            "query": "query SearchPools($pool_tag: String!) {\n    SearchPoolsByTags(\n        tags: { matchesAny: [{matchesAll: [$pool_tag]}]}\n        ) {\n        id\n    }\n}",
            "variables": {
              "pool_tag": "SRv6-ADDRESS-POOL"
            }
          }
        }
      },
      "type": "SIMPLE",
      "decisionCases": {},
      "defaultCase": [],
      "forkTasks": [],
      "startDelay": 0,
      "joinOn": [],
      "optional": false,
      "defaultExclusiveJoinTask": [],
      "asyncComplete": false,
      "loopOver": []
    },
    {
      "name": "LAMBDA_TASK",
      "taskReferenceName": "lambda_Search_root_pool",
      "inputParameters": {
        "lambdaValue": "${graphql_Search_root_pool.output.body}",
        "scriptExpression": "return JSON.parse($.lambdaValue);"
      },
      "type": "LAMBDA",
      "decisionCases": {},
      "defaultCase": [],
      "forkTasks": [],
      "startDelay": 0,
      "joinOn": [],
      "optional": false,
      "defaultExclusiveJoinTask": [],
      "asyncComplete": false,
      "loopOver": []
    },
    {
      "label": "decision",
      "name": "decisionTask",
      "type": "DECISION",
      "taskReferenceName": "decision_tYpT",
      "inputParameters": {
        "param": "${lambda_Search_root_pool.output.result}"
      },
      "caseExpression": "$.param.data.SearchPoolsByTags.length",
      "decisionCases": {
        "0": [
          {
            "name": "HTTP_task",
            "taskReferenceName": "graphql_query_type_range",
            "inputParameters": {
              "http_request": {
                "contentType": "application/json",
                "method": "POST",
                "headers": {
                  "x-tenant-id": "frinx",
                  "from": "workflow",
                  "x-auth-user-groups": "All.ReadWrite"
                },
                "timeout": 3600,
                "uri": "http://uniresource:8884/query",
                "body": {
                  "query": "query QueryIpv6($resource: String) {\n    QueryResourceTypes(byName: $resource) {\n        id   \n    }\n    QueryAllocationStrategies(byName: $resource) {\n        id\n    }\n}",
                  "variables": {
                    "resource": "ipv6_prefix"
                  }
                }
              }
            },
            "type": "SIMPLE",
            "decisionCases": {},
            "defaultCase": [],
            "forkTasks": [],
            "startDelay": 0,
            "joinOn": [],
            "optional": false,
            "defaultExclusiveJoinTask": [],
            "asyncComplete": false,
            "loopOver": []
          },
          {
            "name": "LAMBDA_TASK",
            "taskReferenceName": "lambda_query_type_range",
            "inputParameters": {
              "lambdaValue": "${graphql_query_type_range.output.body}",
              "scriptExpression": "return JSON.parse($.lambdaValue);"
            },
            "type": "LAMBDA",
            "decisionCases": {},
            "defaultCase": [],
            "forkTasks": [],
            "startDelay": 0,
            "joinOn": [],
            "optional": false,
            "defaultExclusiveJoinTask": [],
            "asyncComplete": false,
            "loopOver": []
          },
          {
            "name": "HTTP_task",
            "taskReferenceName": "graphql_create_ipv6_pool",
            "inputParameters": {
              "http_request": {
                "contentType": "application/json",
                "method": "POST",
                "headers": {
                  "x-tenant-id": "frinx",
                  "from": "workflow",
                  "x-auth-user-groups": "All.ReadWrite"
                },
                "timeout": 3600,
                "uri": "http://uniresource:8884/query",
                "body": {
                  "query": "mutation CreatePool(\n    $pool_name: String!,\n    $resource_id: ID!,\n    $strategy_id: ID!,\n    $address: String!,\n    $prefix: Int!) {\n    CreateAllocatingPool(\n        input: {\n            resourceTypeId: $resource_id,\n            poolName: $pool_name,\n            allocationStrategyId: $strategy_id,\n            poolDealocationSafetyPeriod: 0,\n            poolPropertyTypes: {\n                address: \"string\",\n                prefix: \"int\"\n            },\n            poolProperties: {\n                address: $address,\n                prefix: $prefix\n            },\n            tags: [$pool_name, \"do_not_delete\"],\n        }\n    ) {\n        pool { id Name}\n    }\n}",
                  "variables": {
                    "pool_name": "SRv6-ADDRESS-POOL",
                    "resource_id": "${lambda_query_type_range.output.result.data.QueryResourceTypes.0.id}",
                    "strategy_id": "${lambda_query_type_range.output.result.data.QueryAllocationStrategies.0.id}",
                    "address": "fc66:abba::",
                    "prefix": 29
                  }
                }
              }
            },
            "type": "SIMPLE",
            "decisionCases": {},
            "defaultCase": [],
            "forkTasks": [],
            "startDelay": 0,
            "joinOn": [],
            "optional": false,
            "defaultExclusiveJoinTask": [],
            "asyncComplete": false,
            "loopOver": []
          },
          {
            "name": "LAMBDA_TASK",
            "taskReferenceName": "lambda_query_pool_allocation",
            "inputParameters": {
              "lambdaValue": "${graphql_create_ipv6_pool.output.body}",
              "scriptExpression": "return JSON.parse($.lambdaValue);"
            },
            "type": "LAMBDA",
            "decisionCases": {},
            "defaultCase": [],
            "forkTasks": [],
            "startDelay": 0,
            "joinOn": [],
            "optional": false,
            "defaultExclusiveJoinTask": [],
            "asyncComplete": false,
            "loopOver": []
          }
        ]
      },
      "defaultCase": [],
      "startDelay": 0,
      "optional": false
    },
    {
      "name": "LAMBDA_TASK",
      "taskReferenceName": "lambda_PoolId",
      "inputParameters": {
        "lambdaValue": "${lambda_Search_root_pool.output.result}",
        "lambdaValue2": "${lambda_query_pool_allocation.output.result}",
        "scriptExpression": "if ($.lambdaValue.data.SearchPoolsByTags.length > 0)\n\treturn ($.lambdaValue.data.SearchPoolsByTags[\"0\"].id);\nelse\n\treturn ($.lambdaValue2.data.CreateAllocatingPool.pool.id);"
      },
      "type": "LAMBDA",
      "decisionCases": {},
      "defaultCase": [],
      "forkTasks": [],
      "startDelay": 0,
      "joinOn": [],
      "optional": false,
      "defaultExclusiveJoinTask": [],
      "asyncComplete": false,
      "loopOver": []
    },
    {
      "name": "HTTP_task",
      "taskReferenceName": "graphql_Search_locator_pool",
      "inputParameters": {
        "http_request": {
          "contentType": "application/json",
          "method": "POST",
          "headers": {
            "x-tenant-id": "frinx",
            "from": "workflow",
            "x-auth-user-groups": "All.ReadWrite"
          },
          "timeout": 3600,
          "uri": "http://uniresource:8884/query",
          "body": {
            "query": "query SearchPools($pool_tag: String!) {\n    SearchPoolsByTags(\n        tags: { matchesAny: [{matchesAll: [$pool_tag]}]}\n        ) {\n        id\n    }\n}",
            "variables": {
              "pool_tag": "SRv6-${workflow.input.locator}-POOL"
            }
          }
        }
      },
      "type": "SIMPLE",
      "decisionCases": {},
      "defaultCase": [],
      "forkTasks": [],
      "startDelay": 0,
      "joinOn": [],
      "optional": false,
      "defaultExclusiveJoinTask": [],
      "asyncComplete": false,
      "loopOver": []
    },
    {
      "name": "LAMBDA_TASK",
      "taskReferenceName": "lambda_Search_locator_pool",
      "inputParameters": {
        "lambdaValue": "${graphql_Search_locator_pool.output.body}",
        "scriptExpression": "return JSON.parse($.lambdaValue);"
      },
      "type": "LAMBDA",
      "decisionCases": {},
      "defaultCase": [],
      "forkTasks": [],
      "startDelay": 0,
      "joinOn": [],
      "optional": false,
      "defaultExclusiveJoinTask": [],
      "asyncComplete": false,
      "loopOver": []
    },
    {
      "label": "decision",
      "name": "decisionTask",
      "type": "DECISION",
      "taskReferenceName": "decision_is_pool_locator_exists",
      "inputParameters": {
        "param": "${lambda_Search_locator_pool.output.result}"
      },
      "caseExpression": "$.param.data.SearchPoolsByTags.length",
      "decisionCases": {
        "0": [
          {
            "name": "HTTP_task",
            "taskReferenceName": "graphql_query_type_range_1",
            "inputParameters": {
              "http_request": {
                "contentType": "application/json",
                "method": "POST",
                "headers": {
                  "x-tenant-id": "frinx",
                  "from": "workflow",
                  "x-auth-user-groups": "All.ReadWrite"
                },
                "timeout": 3600,
                "uri": "http://uniresource:8884/query",
                "body": {
                  "query": "query QueryIpv6($resource: String) {\n    QueryResourceTypes(byName: $resource) {\n        id   \n    }\n    QueryAllocationStrategies(byName: $resource) {\n        id\n    }\n}",
                  "variables": {
                    "resource": "ipv6_prefix"
                  }
                }
              }
            },
            "type": "SIMPLE",
            "decisionCases": {},
            "defaultCase": [],
            "forkTasks": [],
            "startDelay": 0,
            "joinOn": [],
            "optional": false,
            "defaultExclusiveJoinTask": [],
            "asyncComplete": false,
            "loopOver": []
          },
          {
            "name": "LAMBDA_TASK",
            "taskReferenceName": "lambda_query_type_range_1",
            "inputParameters": {
              "lambdaValue": "${graphql_query_type_range_1.output.body}",
              "scriptExpression": "return JSON.parse($.lambdaValue);"
            },
            "type": "LAMBDA",
            "decisionCases": {},
            "defaultCase": [],
            "forkTasks": [],
            "startDelay": 0,
            "joinOn": [],
            "optional": false,
            "defaultExclusiveJoinTask": [],
            "asyncComplete": false,
            "loopOver": []
          },
          {
            "name": "HTTP_task",
            "taskReferenceName": "graphql_claim_root_srv6_address",
            "inputParameters": {
              "http_request": {
                "contentType": "application/json",
                "method": "POST",
                "headers": {
                  "x-tenant-id": "frinx",
                  "from": "workflow",
                  "x-auth-user-groups": "OWNER"
                },
                "timeout": 3600,
                "uri": "http://krakend:8080/api/uniresource",
                "body": {
                  "query": "mutation claimIpv6Resource($poolId: ID!, $description: String, $alternativeId: Map!) {\n                ClaimResourceWithAltId( poolId: $poolId, description: $description, userInput: {desiredSize: \"79228162514264337593543950336\"}, alternativeId: $alternativeId){\n                    id\n                    Properties\n                    AlternativeId\n             }\n            }",
                  "variables": {
                    "poolId": "${lambda_PoolId.output.result}",
                    "alternativeId": {
                      "status": "active",
                      "node_id": "${workflow.input.node_id}",
                      "locator": "${workflow.input.locator}"
                    },
                    "description": "Parent srv6 root resource."
                  }
                }
              }
            },
            "type": "SIMPLE",
            "decisionCases": {},
            "defaultCase": [],
            "forkTasks": [],
            "startDelay": 0,
            "joinOn": [],
            "optional": false,
            "defaultExclusiveJoinTask": [],
            "asyncComplete": false,
            "loopOver": []
          },
          {
            "name": "LAMBDA_TASK",
            "taskReferenceName": "lambda_claim_root_srv6_address",
            "inputParameters": {
              "lambdaValue": "${graphql_claim_root_srv6_address.output.body}",
              "scriptExpression": "return JSON.parse($.lambdaValue);"
            },
            "type": "LAMBDA",
            "decisionCases": {},
            "defaultCase": [],
            "forkTasks": [],
            "startDelay": 0,
            "joinOn": [],
            "optional": false,
            "defaultExclusiveJoinTask": [],
            "asyncComplete": false,
            "loopOver": []
          },
          {
            "name": "HTTP_task",
            "taskReferenceName": "graphql_create_srv6_nested_pool",
            "inputParameters": {
              "http_request": {
                "contentType": "application/json",
                "method": "POST",
                "headers": {
                  "x-tenant-id": "frinx",
                  "from": "workflow",
                  "x-auth-user-groups": "All.ReadWrite"
                },
                "timeout": 3600,
                "uri": "http://uniresource:8884/query",
                "body": {
                  "query": "mutation CreateNestedAllocPool(\n    $pool_name: String!,\n    $resource_id: ID!,\n    $strategy_id: ID!,\n    $parentResourceId: ID!) {\n    CreateNestedAllocatingPool(\n        input: {\n            resourceTypeId: $resource_id,\n            poolName: $pool_name,\n            allocationStrategyId: $strategy_id,\n            poolDealocationSafetyPeriod: 0,\n             parentResourceId: $parentResourceId,\n           tags: [$pool_name, \"do_not_delete\"],\n        }\n    ) {\n        pool { id Name}\n    }\n}",
                  "variables": {
                    "pool_name": "SRv6-${workflow.input.locator}-POOL",
                    "resource_id": "${lambda_query_type_range_1.output.result.data.QueryResourceTypes.0.id}",
                    "strategy_id": "${lambda_query_type_range_1.output.result.data.QueryAllocationStrategies.0.id}",
                    "parentResourceId": "${lambda_claim_root_srv6_address.output.result.data.ClaimResourceWithAltId.id}"
                  }
                }
              }
            },
            "type": "SIMPLE",
            "decisionCases": {},
            "defaultCase": [],
            "forkTasks": [],
            "startDelay": 0,
            "joinOn": [],
            "optional": false,
            "defaultExclusiveJoinTask": [],
            "asyncComplete": false,
            "loopOver": []
          },
          {
            "name": "LAMBDA_TASK",
            "taskReferenceName": "lambda_create_srv6_nested_pool",
            "inputParameters": {
              "lambdaValue": "${graphql_create_srv6_nested_pool.output.body}",
              "scriptExpression": "return JSON.parse($.lambdaValue);"
            },
            "type": "LAMBDA",
            "decisionCases": {},
            "defaultCase": [],
            "forkTasks": [],
            "startDelay": 0,
            "joinOn": [],
            "optional": false,
            "defaultExclusiveJoinTask": [],
            "asyncComplete": false,
            "loopOver": []
          },
          {
            "name": "HTTP_task",
            "taskReferenceName": "graphql_claim_first_reserved_srv6_address",
            "inputParameters": {
              "http_request": {
                "contentType": "application/json",
                "method": "POST",
                "headers": {
                  "x-tenant-id": "frinx",
                  "from": "workflow",
                  "x-auth-user-groups": "OWNER"
                },
                "timeout": 3600,
                "uri": "http://krakend:8080/api/uniresource",
                "body": {
                  "query": "mutation claimIpv6Resource($poolId: ID!, $description: String, $alternativeId: Map!) {\n                ClaimResourceWithAltId( poolId: $poolId, description: $description, userInput: {desiredSize: \"39614081257132168796771975168\"}, alternativeId: $alternativeId){\n                    id\n                    Properties\n                    AlternativeId\n             }\n            }",
                  "variables": {
                    "poolId": "${lambda_create_srv6_nested_pool.output.result.data.CreateNestedAllocatingPool.pool.id}",
                    "alternativeId": {
                      "status": "active",
                      "node_id": "${workflow.input.node_id}"
                    },
                    "description": "Nested srv6 reserved resource."
                  }
                }
              }
            },
            "type": "SIMPLE",
            "decisionCases": {},
            "defaultCase": [],
            "forkTasks": [],
            "startDelay": 0,
            "joinOn": [],
            "optional": false,
            "defaultExclusiveJoinTask": [],
            "asyncComplete": false,
            "loopOver": []
          },
          {
            "name": "HTTP_task",
            "taskReferenceName": "graphql_claim_second_reserved_srv6_address",
            "inputParameters": {
              "http_request": {
                "contentType": "application/json",
                "method": "POST",
                "headers": {
                  "x-tenant-id": "frinx",
                  "from": "workflow",
                  "x-auth-user-groups": "OWNER"
                },
                "timeout": 3600,
                "uri": "http://krakend:8080/api/uniresource",
                "body": {
                  "query": "mutation claimIpv6Resource($poolId: ID!, $description: String, $alternativeId: Map!) {\n                ClaimResourceWithAltId( poolId: $poolId, description: $description, userInput: {desiredSize: \"19807040628566084398385987584\"}, alternativeId: $alternativeId){\n                    id\n                    Properties\n                    AlternativeId\n             }\n            }",
                  "variables": {
                    "poolId": "${lambda_create_srv6_nested_pool.output.result.data.CreateNestedAllocatingPool.pool.id}",
                    "alternativeId": {
                      "status": "active",
                      "node_id": "${workflow.input.node_id}"
                    },
                    "description": "Nested srv6 reserved resource."
                  }
                }
              }
            },
            "type": "SIMPLE",
            "decisionCases": {},
            "defaultCase": [],
            "forkTasks": [],
            "startDelay": 0,
            "joinOn": [],
            "optional": false,
            "defaultExclusiveJoinTask": [],
            "asyncComplete": false,
            "loopOver": []
          },
          {
            "name": "HTTP_task",
            "taskReferenceName": "graphql_claim_third_reserved_srv6_address",
            "inputParameters": {
              "http_request": {
                "contentType": "application/json",
                "method": "POST",
                "headers": {
                  "x-tenant-id": "frinx",
                  "from": "workflow",
                  "x-auth-user-groups": "OWNER"
                },
                "timeout": 3600,
                "uri": "http://krakend:8080/api/uniresource",
                "body": {
                  "query": "mutation claimIpv6Resource($poolId: ID!, $description: String, $alternativeId: Map!) {\n                ClaimResourceWithAltId( poolId: $poolId, description: $description, userInput: {desiredSize: \"2475880078570760549798248448\"}, alternativeId: $alternativeId){\n                    id\n                    Properties\n                    AlternativeId\n             }\n            }",
                  "variables": {
                    "poolId": "${lambda_create_srv6_nested_pool.output.result.data.CreateNestedAllocatingPool.pool.id}",
                    "alternativeId": {
                      "status": "active",
                      "node_id": "${workflow.input.node_id}"
                    },
                    "description": "Nested srv6 reserved resource."
                  }
                }
              }
            },
            "type": "SIMPLE",
            "decisionCases": {},
            "defaultCase": [],
            "forkTasks": [],
            "startDelay": 0,
            "joinOn": [],
            "optional": false,
            "defaultExclusiveJoinTask": [],
            "asyncComplete": false,
            "loopOver": []
          },
          {
            "name": "HTTP_task",
            "taskReferenceName": "graphql_claim_fourth_reserved_srv6_address",
            "inputParameters": {
              "http_request": {
                "contentType": "application/json",
                "method": "POST",
                "headers": {
                  "x-tenant-id": "frinx",
                  "from": "workflow",
                  "x-auth-user-groups": "OWNER"
                },
                "timeout": 3600,
                "uri": "http://krakend:8080/api/uniresource",
                "body": {
                  "query": "mutation claimIpv6Resource($poolId: ID!, $description: String, $alternativeId: Map!) {\n                ClaimResourceWithAltId( poolId: $poolId, description: $description, userInput: {desiredSize: \"618970019642690137449562112\"}, alternativeId: $alternativeId){\n                    id\n                    Properties\n                    AlternativeId\n             }\n            }",
                  "variables": {
                    "poolId": "${lambda_create_srv6_nested_pool.output.result.data.CreateNestedAllocatingPool.pool.id}",
                    "alternativeId": {
                      "status": "active",
                      "node_id": "${workflow.input.node_id}"
                    },
                    "description": "Nested srv6 reserved resource."
                  }
                }
              }
            },
            "type": "SIMPLE",
            "decisionCases": {},
            "defaultCase": [],
            "forkTasks": [],
            "startDelay": 0,
            "joinOn": [],
            "optional": false,
            "defaultExclusiveJoinTask": [],
            "asyncComplete": false,
            "loopOver": []
          },
          {
            "name": "HTTP_task",
            "taskReferenceName": "graphql_claim_fifth_reserved_srv6_address",
            "inputParameters": {
              "http_request": {
                "contentType": "application/json",
                "method": "POST",
                "headers": {
                  "x-tenant-id": "frinx",
                  "from": "workflow",
                  "x-auth-user-groups": "OWNER"
                },
                "timeout": 3600,
                "uri": "http://krakend:8080/api/uniresource",
                "body": {
                  "query": "mutation claimIpv6Resource($poolId: ID!, $description: String, $alternativeId: Map!) {\n                ClaimResourceWithAltId( poolId: $poolId, description: $description, userInput: {desiredSize: \"154742504910672534362390528\"}, alternativeId: $alternativeId){\n                    id\n                    Properties\n                    AlternativeId\n             }\n            }",
                  "variables": {
                    "poolId": "${lambda_create_srv6_nested_pool.output.result.data.CreateNestedAllocatingPool.pool.id}",
                    "alternativeId": {
                      "status": "active",
                      "node_id": "${workflow.input.node_id}"
                    },
                    "description": "Nested srv6 reserved resource."
                  }
                }
              }
            },
            "type": "SIMPLE",
            "decisionCases": {},
            "defaultCase": [],
            "forkTasks": [],
            "startDelay": 0,
            "joinOn": [],
            "optional": false,
            "defaultExclusiveJoinTask": [],
            "asyncComplete": false,
            "loopOver": []
          },
          {
            "name": "HTTP_task",
            "taskReferenceName": "graphql_claim_sixth_reserved_srv6_address",
            "inputParameters": {
              "http_request": {
                "contentType": "application/json",
                "method": "POST",
                "headers": {
                  "x-tenant-id": "frinx",
                  "from": "workflow",
                  "x-auth-user-groups": "OWNER"
                },
                "timeout": 3600,
                "uri": "http://krakend:8080/api/uniresource",
                "body": {
                  "query": "mutation claimIpv6Resource($poolId: ID!, $description: String, $alternativeId: Map!) {\n                ClaimResourceWithAltId( poolId: $poolId, description: $description, userInput: {desiredSize: \"77371252455336267181195264\"}, alternativeId: $alternativeId){\n                    id\n                    Properties\n                    AlternativeId\n             }\n            }",
                  "variables": {
                    "poolId": "${lambda_create_srv6_nested_pool.output.result.data.CreateNestedAllocatingPool.pool.id}",
                    "alternativeId": {
                      "status": "active",
                      "node_id": "${workflow.input.node_id}"
                    },
                    "description": "Nested srv6 reserved resource."
                  }
                }
              }
            },
            "type": "SIMPLE",
            "decisionCases": {},
            "defaultCase": [],
            "forkTasks": [],
            "startDelay": 0,
            "joinOn": [],
            "optional": false,
            "defaultExclusiveJoinTask": [],
            "asyncComplete": false,
            "loopOver": []
          },
          {
            "name": "HTTP_task",
            "taskReferenceName": "graphql_claim_seventh_reserved_srv6_address",
            "inputParameters": {
              "http_request": {
                "contentType": "application/json",
                "method": "POST",
                "headers": {
                  "x-tenant-id": "frinx",
                  "from": "workflow",
                  "x-auth-user-groups": "OWNER"
                },
                "timeout": 3600,
                "uri": "http://krakend:8080/api/uniresource",
                "body": {
                  "query": "mutation claimIpv6Resource($poolId: ID!, $description: String, $alternativeId: Map!) {\n                ClaimResourceWithAltId( poolId: $poolId, description: $description, userInput: {desiredSize: \"38685626227668133590597632\"}, alternativeId: $alternativeId){\n                    id\n                    Properties\n                    AlternativeId\n             }\n            }",
                  "variables": {
                    "poolId": "${lambda_create_srv6_nested_pool.output.result.data.CreateNestedAllocatingPool.pool.id}",
                    "alternativeId": {
                      "status": "active",
                      "node_id": "${workflow.input.node_id}"
                    },
                    "description": "Nested srv6 reserved resource."
                  }
                }
              }
            },
            "type": "SIMPLE",
            "decisionCases": {},
            "defaultCase": [],
            "forkTasks": [],
            "startDelay": 0,
            "joinOn": [],
            "optional": false,
            "defaultExclusiveJoinTask": [],
            "asyncComplete": false,
            "loopOver": []
          },
          {
            "name": "HTTP_task",
            "taskReferenceName": "graphql_claim_eighth_reserved_srv6_address",
            "inputParameters": {
              "http_request": {
                "contentType": "application/json",
                "method": "POST",
                "headers": {
                  "x-tenant-id": "frinx",
                  "from": "workflow",
                  "x-auth-user-groups": "OWNER"
                },
                "timeout": 3600,
                "uri": "http://krakend:8080/api/uniresource",
                "body": {
                  "query": "mutation claimIpv6Resource($poolId: ID!, $description: String, $alternativeId: Map!) {\n                ClaimResourceWithAltId( poolId: $poolId, description: $description, userInput: {desiredSize: \"19342813113834066795298816\"}, alternativeId: $alternativeId){\n                    id\n                    Properties\n                    AlternativeId\n             }\n            }",
                  "variables": {
                    "poolId": "${lambda_create_srv6_nested_pool.output.result.data.CreateNestedAllocatingPool.pool.id}",
                    "alternativeId": {
                      "status": "active",
                      "node_id": "${workflow.input.node_id}"
                    },
                    "description": "Nested srv6 reserved resource."
                  }
                }
              }
            },
            "type": "SIMPLE",
            "decisionCases": {},
            "defaultCase": [],
            "forkTasks": [],
            "startDelay": 0,
            "joinOn": [],
            "optional": false,
            "defaultExclusiveJoinTask": [],
            "asyncComplete": false,
            "loopOver": []
          },
          {
            "name": "HTTP_task",
            "taskReferenceName": "graphql_claim_ninth_reserved_srv6_address",
            "inputParameters": {
              "http_request": {
                "contentType": "application/json",
                "method": "POST",
                "headers": {
                  "x-tenant-id": "frinx",
                  "from": "workflow",
                  "x-auth-user-groups": "OWNER"
                },
                "timeout": 3600,
                "uri": "http://krakend:8080/api/uniresource",
                "body": {
                  "query": "mutation claimIpv6Resource($poolId: ID!, $description: String, $alternativeId: Map!) {\n                ClaimResourceWithAltId( poolId: $poolId, description: $description, userInput: {desiredSize: \"9671406556917033397649408\"}, alternativeId: $alternativeId){\n                    id\n                    Properties\n                    AlternativeId\n             }\n            }",
                  "variables": {
                    "poolId": "${lambda_create_srv6_nested_pool.output.result.data.CreateNestedAllocatingPool.pool.id}",
                    "alternativeId": {
                      "status": "active",
                      "node_id": "${workflow.input.node_id}"
                    },
                    "description": "Nested srv6 reserved resource."
                  }
                }
              }
            },
            "type": "SIMPLE",
            "decisionCases": {},
            "defaultCase": [],
            "forkTasks": [],
            "startDelay": 0,
            "joinOn": [],
            "optional": false,
            "defaultExclusiveJoinTask": [],
            "asyncComplete": false,
            "loopOver": []
          },
          {
            "name": "HTTP_task",
            "taskReferenceName": "graphql_claim_tenth_reserved_srv6_address",
            "inputParameters": {
              "http_request": {
                "contentType": "application/json",
                "method": "POST",
                "headers": {
                  "x-tenant-id": "frinx",
                  "from": "workflow",
                  "x-auth-user-groups": "OWNER"
                },
                "timeout": 3600,
                "uri": "http://krakend:8080/api/uniresource",
                "body": {
                  "query": "mutation claimIpv6Resource($poolId: ID!, $description: String, $alternativeId: Map!) {\n                ClaimResourceWithAltId( poolId: $poolId, description: $description, userInput: {desiredSize: \"4835703278458516698824704\"}, alternativeId: $alternativeId){\n                    id\n                    Properties\n                    AlternativeId\n             }\n            }",
                  "variables": {
                    "poolId": "${lambda_create_srv6_nested_pool.output.result.data.CreateNestedAllocatingPool.pool.id}",
                    "alternativeId": {
                      "status": "active",
                      "node_id": "${workflow.input.node_id}"
                    },
                    "description": "Nested srv6 reserved resource."
                  }
                }
              }
            },
            "type": "SIMPLE",
            "decisionCases": {},
            "defaultCase": [],
            "forkTasks": [],
            "startDelay": 0,
            "joinOn": [],
            "optional": false,
            "defaultExclusiveJoinTask": [],
            "asyncComplete": false,
            "loopOver": []
          },
          {
            "name": "HTTP_task",
            "taskReferenceName": "graphql_claim_eleventh_reserved_srv6_address",
            "inputParameters": {
              "http_request": {
                "contentType": "application/json",
                "method": "POST",
                "headers": {
                  "x-tenant-id": "frinx",
                  "from": "workflow",
                  "x-auth-user-groups": "OWNER"
                },
                "timeout": 3600,
                "uri": "http://krakend:8080/api/uniresource",
                "body": {
                  "query": "mutation claimIpv6Resource($poolId: ID!, $description: String, $alternativeId: Map!) {\n                ClaimResourceWithAltId( poolId: $poolId, description: $description, userInput: {desiredSize: \"1208925819614629174706176\"}, alternativeId: $alternativeId){\n                    id\n                    Properties\n                    AlternativeId\n             }\n            }",
                  "variables": {
                    "poolId": "${lambda_create_srv6_nested_pool.output.result.data.CreateNestedAllocatingPool.pool.id}",
                    "alternativeId": {
                      "status": "active",
                      "node_id": "${workflow.input.node_id}"
                    },
                    "description": "Nested srv6 reserved resource."
                  }
                }
              }
            },
            "type": "SIMPLE",
            "decisionCases": {},
            "defaultCase": [],
            "forkTasks": [],
            "startDelay": 0,
            "joinOn": [],
            "optional": false,
            "defaultExclusiveJoinTask": [],
            "asyncComplete": false,
            "loopOver": []
          },
          {
            "name": "HTTP_task",
            "taskReferenceName": "graphql_claim_twelfth_reserved_srv6_address",
            "inputParameters": {
              "http_request": {
                "contentType": "application/json",
                "method": "POST",
                "headers": {
                  "x-tenant-id": "frinx",
                  "from": "workflow",
                  "x-auth-user-groups": "OWNER"
                },
                "timeout": 3600,
                "uri": "http://krakend:8080/api/uniresource",
                "body": {
                  "query": "mutation claimIpv6Resource($poolId: ID!, $description: String, $alternativeId: Map!) {\n                ClaimResourceWithAltId( poolId: $poolId, description: $description, userInput: {desiredSize: \"1208925819614629174706176\"}, alternativeId: $alternativeId){\n                    id\n                    Properties\n                    AlternativeId\n             }\n            }",
                  "variables": {
                    "poolId": "${lambda_create_srv6_nested_pool.output.result.data.CreateNestedAllocatingPool.pool.id}",
                    "alternativeId": {
                      "status": "active",
                      "node_id": "${workflow.input.node_id}"
                    },
                    "description": "Nested srv6 reserved resource."
                  }
                }
              }
            },
            "type": "SIMPLE",
            "decisionCases": {},
            "defaultCase": [],
            "forkTasks": [],
            "startDelay": 0,
            "joinOn": [],
            "optional": false,
            "defaultExclusiveJoinTask": [],
            "asyncComplete": false,
            "loopOver": []
          }
        ]
      },
      "defaultCase": [],
      "startDelay": 0,
      "optional": false
    },
    {
      "name": "LAMBDA_TASK",
      "taskReferenceName": "lambda_Nested_PoolId",
      "inputParameters": {
        "lambdaValue": "${lambda_Search_locator_pool.output.result}",
        "lambdaValue2": "${lambda_create_srv6_nested_pool.output.result}",
        "scriptExpression": "if ($.lambdaValue.data.SearchPoolsByTags.length > 0)\n\treturn ($.lambdaValue.data.SearchPoolsByTags[\"0\"].id);\nelse\n\treturn ($.lambdaValue2.data.CreateNestedAllocatingPool.pool.id);"
      },
      "type": "LAMBDA",
      "decisionCases": {},
      "defaultCase": [],
      "forkTasks": [],
      "startDelay": 0,
      "joinOn": [],
      "optional": false,
      "defaultExclusiveJoinTask": [],
      "asyncComplete": false,
      "loopOver": []
    },
    {
      "name": "HTTP_task",
      "taskReferenceName": "graphql_claim_srv6_address",
      "inputParameters": {
        "http_request": {
          "contentType": "application/json",
          "method": "POST",
          "headers": {
            "x-tenant-id": "frinx",
            "from": "workflow",
            "x-auth-user-groups": "OWNER"
          },
          "timeout": 3600,
          "uri": "http://krakend:8080/api/uniresource",
          "body": {
            "query": "mutation claimIpv6Resource($poolId: ID!, $description: String, $alternativeId: Map!) {\n                ClaimResourceWithAltId( poolId: $poolId, description: $description, userInput: {desiredSize: \"1208925819614629174706176\"}, alternativeId: $alternativeId){\n                    id\n                    Properties\n                    AlternativeId\n             }\n            }",
            "variables": {
              "poolId": "${lambda_Nested_PoolId.output.result}",
              "alternativeId": {
                "status": "active",
                "node_id": "${workflow.input.node_id}"
              },
              "description": "${workflow.input.node_id}"
            }
          }
        }
      },
      "type": "SIMPLE",
      "decisionCases": {},
      "defaultCase": [],
      "forkTasks": [],
      "startDelay": 0,
      "joinOn": [],
      "optional": false,
      "defaultExclusiveJoinTask": [],
      "asyncComplete": false,
      "loopOver": []
    },
    {
      "name": "LAMBDA_TASK",
      "taskReferenceName": "lambda_claim_srv6_address",
      "inputParameters": {
        "lambdaValue": "${graphql_claim_srv6_address.output.body}",
        "scriptExpression": "return JSON.parse($.lambdaValue);"
      },
      "type": "LAMBDA",
      "decisionCases": {},
      "defaultCase": [],
      "forkTasks": [],
      "startDelay": 0,
      "joinOn": [],
      "optional": false,
      "defaultExclusiveJoinTask": [],
      "asyncComplete": false,
      "loopOver": []
    }
  ],
  "schemaVersion": 2,
  "restartable": true,
  "inputParameters": [],
  "outputParameters": {
    "result": {
      "address": "${lambda_claim_srv6_address.output.result.data.ClaimResourceWithAltId.Properties.address}",
      "prefix": "${lambda_claim_srv6_address.output.result.data.ClaimResourceWithAltId.Properties.prefix}"
    }
  },
  "workflowStatusListenerEnabled": false,
  "ownerEmail": "admin-user",
  "timeoutPolicy": "ALERT_ONLY",
  "timeoutSeconds": 0,
  "hasSchedule": false,
  "expectedScheduleName": "Allocate_SRv6_address:1"
}